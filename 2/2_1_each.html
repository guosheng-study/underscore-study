<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>2.1 - each</title>
</head>

<body>

<div id="each" class="floor-inner">
	<h4>2.1 - each(循环)</h4>
    <p>语法: _.each(list, iterator, [context])</p>
    <p>别名: forEach</p>
    <p>关键词：<em>循环</em>。</p>
    <h6>a) - 用each循环数组</h6>
    <div class="editor" style="height:220px;">
//_.each()方法可以用来循环数组.

_.each([11, 22, 33], function (d, index) {
    //d返回的是值，index返回的index
    console.log([d, index]); 
});

//=>
//[11, 0]
//[22, 1]
//[22, 2]
</div>
<div class="jsfiddle-link"><a>http://jsfiddle.net/kyo4311/5aa4Y/</a></div>
<p>上例_.each()方法传入了两个参数。第一个参数传了一个数组，第二个参数是一个回调函数。而回调函数第一个返回值即是数组中的值，第二个返回值是序号。</p>


<h6>b) - 用each循环对象</h6>
<div class="editor" style="height:210px;">
//_.each()方法也可以用来循环对象.

_.each({one: '一', two: '二', three: '三'}, function(val, key){
    //val返回的是键值，key返回的键名
    console.log([val, key]);
});

//=>
//["一", "one"]
//["二", "two"]
//["三", "three"]
</div>
<div class="jsfiddle-link"><a>http://jsfiddle.net/kyo4311/2v4QV/</a></div>
<p>_.each()也可以循环对象。同样传入了两个参数，第一个参数是一个对象，第二个参数是回调函数。而回调函数的第一个是值对象的值，第二个是对象的键名。</p>


<h6>c) - each里面的this是什么?</h6>
<div class="editor" style="height:100px;">
_.each([11, 22, 33], function () {
    //原来this指向全局Window
    console.log(this);
});
</div>
<div class="jsfiddle-link"><a>http://jsfiddle.net/kyo4311/UK9Ec/</a></div>
<p>通过上面这个例子，我们可以清楚的看到，在each里面，原来this指向了全局，在WEB环境中指向了Window。</p>

<h6>d) - context参数说明</h6>
<div class="editor" style="height:140px;">
var obj = {
    test: 1
};
_.each([1, 2, 3], function (i) {
    console.log(this); //现在的this已经指向了obj.
}, obj);
</div>
<div class="jsfiddle-link"><a>http://jsfiddle.net/kyo4311/H36ED/</a></div>
<p>当each传入了context之后，this将不在是Window了,指向了context。这样子就很方便的把外部的变量传入到each里面。</p>


<h6>e) - iterator参数说明</h6>
<div class="editor" style="height:80px;">
_.each([1, 2, 3], function (d, i, list) {
    console.log(list); //[1, 2, 3]
});
</div>
<div class="jsfiddle-link"><a>http://jsfiddle.net/kyo4311/Yhn7P/</a></div>

<p>iterator回调方法会传递三个参数：(element, index, list)，前两个参数的用法在前面的例子中已经展示，第三个参数则是指向了list本身。虽然他传递了三个参数，事实情况可以根据需要选用参数，可以只用一个element，甚至一个也不用也不会有问题。</p>

<p>很多Js库或是前库框架里都有each方法，有兴趣的同学可以看一下jQuery里的each：
<a href="http://api.jquery.com/jQuery.each/" target="_blank">http://api.jquery.com/jQuery.each/</a>和Kissy里的each:<a href="http://docs.kissyui.com/1.4/docs/html/api/lang/each.html" target="_blank">http://docs.kissyui.com/1.4/docs/html/api/lang/each.html</a>以便加深理解。</p>

<p>使用each有以下几个理由：</p>
<ol>
	<li>代码清晰，因为用for循环的时候肯定增加length和i这两个变量。</li>
    <li>使用简单，不需要区别，循环数组的时候我们要用for循环，循环对象的时候用for in循环。</li>
    <li>效率保证，因为使用for循环有很多优化讲究，而用for in循环对象的时候，则要判断一个对象是否包含自定义属性而不是原型链上的属性等。</li>
</ol>
</div>
</body>
</html>
